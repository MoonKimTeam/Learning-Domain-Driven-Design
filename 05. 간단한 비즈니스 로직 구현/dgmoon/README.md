# ch.05 간단한 비즈니스 로직 구현

## 트랜잭션 스크립트

- 트랜잭션 스크립트 패턴은 프로시저를 기반으로 시스템의 비즈니스 로직을 구성함
- 각 프로시저는 퍼블릭 인터페이스를 통해 시스템 사용자가 실행하는 작업을 구현

### 구현

- 절차지향 스크립트로 구현

### 그렇게 쉽진 않다!

- 겉보기엔 단순한데, 가장 틀리기 쉬운 패턴

### 트랜잭션 동작 구현 실패

- 테이블은 업데이트되고 나서 로그 레코드를 성공적으로 추가하기 전에 시스템이 일관되지 않은 상태가 됨

### 분산 트랜잭션

- 최신 분산 시스템에서는 DB 데이터를 변경한 다음 메시지 버스에 메시지를 발행하여 시스템의 다른 컴포넌트에 변경을 알리는 게 일반적
- 여러 저장 장치에 걸쳐 있는 분산 트랜잭션은 복잡하고 확장하기 어렵고 오류가 발생하기 쉬우므로 일반적으로 피하는 방식

### 암시적 분산 트랜잭션

- 마지막 방문 날짜를 추적하는 대신 이 메서드를 각 사용자에 대한 방문 카운터를 유지
- 혹은 낙관적 동시성 제어 사용

### 트랜잭션 스크립트를 사용하는 경우

- 비즈니스 로직이 단순한 절차적 작업처럼 매우 간단한 문제 도메인에 효과적

## 액티브 레코드

- 비즈니스 로직이 단순한 경우 사용
- 오브젝트 트리와 계층을 가짐

### 구현

- 액티브 레코드라고 하는 전용 객체를 사용하여 복잡한 자료구조를 표현
- ORM이나 다른 접근 프레임워크와도 관련 있음

### 액티브 레코드를 사용하는 경우

- 트랜잭션 스크립트 패턴과 마찬가지로 액티브 레코드 패턴은 지원 하위 도메인, 일반 하위 도메인과 외부 솔루션의 연동, 모델 변환 작업에 적합

## 실용적인 접근 방식

- 대규모로 데이터를 다루는 시스템에서는 데이터의 일관성 보장이 덜 엄격할 수 있음