# 도메인 지식 찾아내기

> "운영환경에 배포되는 것은 도메인 전문가의 지식이 아니라 개발자의 이해 혹은 오해다."  
> — 알베르토 브랜돌리니(Alberto Brandolini)

## 비즈니스 문제

우리가 개발하는 소프트웨어 시스템은 비즈니스 문제를 해결하는 솔루션입니다. 여기서 언급한 문제(problem)는 수학 문제나 수수께끼처럼 풀 수 있고 완료할 수 있는 그런 것이 아닙니다.  
비즈니스 도메인의 컨텍스트에서 '문제'라는 것은 경영하려다, 비즈니스 문제는 워크플로우와 프로세스 최적화, 수작업 최소화, 자원 관리, 의사결정 지원, 데이터 관리 등과 관련된 과제일 수 있습니다.

## 도메인 지식 찾아내기

효과적인 소프트웨어 솔루션을 설계하려면 적어도 기본적인 비즈니스 도메인 지식이 있어야 합니다. 1장에서 논의했듯이 이런 지식은 도메인 전문가의 영역입니다. 비즈니스 도메인의 모든 복잡성을 이해하고 전문성을 갖추는 것은 그들의 임무입니다.

### 커뮤니케이션

거의 모든 소프트웨어 프로젝트에는 도메인 전문가, 프로젝트 소유자, 엔지니어, UI/UX 디자이너, 프로젝트 매니저, 테스터, 분석가 등 다양한 역할의 이해관계자들 협업이 필요합니다.

소프트웨어 프로젝트가 실패하는 이유에 대한 연구에서 효과적인 커뮤니케이션이 지식 공유를 통한 프로젝트 성공에 필수적인 것을 밝혔습니다. 이렇게 중요한데도, 소프트웨어의 프로젝트에서 효과적인 커뮤니케이션을 목격하기는 어렵습니다.

### 모델 변환 문제

전통적인 소프트웨어 개발 생애주기에서 도메인 지식은 분석 모델(analysis model)로 알려진 엔지니어 친화적인 형태로 '변환'됩니다. 분석 모델은 도메인 지식이 변이만 존재하는 비즈니스 도메인을 기반하기보다는 시스템 요구사항을 설명하는 것에 지나지 않습니다.

결국 소스코드가 나중에 프로젝트를 유지관리할 소프트웨어 엔지니어에게만 비즈니스 도메인 지식을 전달하는 데 사용됩니다.

## 유비쿼터스 언어란 무엇인가?

**유비쿼터스 언어**를 사용하는 것은 도메인 주도 설계의 초석입니다. 아이디어는 간단합니다. 참가자들이 효과적으로 소통하기 위해 변환에 의존하지 말고 같은 언어를 사용하자는 것입니다.

### 비즈니스 언어

유비쿼터스 언어는 비즈니스 언어라는 점을 강조하고 싶습니다. 그렇기 때문에 기술 용어는 유비쿼터스 도메인에 관련된 용어로만 구성해야 합니다.

유비쿼터스 언어는 도메인 전문가의 이해와 비즈니스 도메인에 대한 멘탈 모델을 설명하며 이해하기 쉬운 단어로 표현하는 것을 목표로 합니다.

### 일관성

유비쿼터스 언어는 반드시 정확하고 일관성이 있어야 합니다. 가장할 말로가 없어야 하고 비즈니스 도메인의 로직을 명료하게 표현해야 합니다.

모호성이 커뮤니케이션을 방해하기 때문에 유비쿼터스 언어의 용어는 오직 하나의 의미만 가져야 합니다. 불분명한 용어의 몇 가지 예와 개선 방법을 살펴보겠습니다.

### 모호한 용어

어떤 비즈니스 도메인에서는 **정책(policy)** 이라는 용어가 규제 규칙 또는 보험 계약과 같은 여러 의미를 가집니다. 정확한 의미는 매년에 따라 사람 간의 상호작용을 통해서만 알 수 있습니다. 그러나 소프트웨어는 모호성에 잘 대처하지 못하며, '정책'이라는 개체(entity)를 코드로 모델링하기 어려울 수 있습니다.

유비쿼터스 언어는 용어에 한 단일 의미를 갖게 하기 때문에 '정책'의 경우 '규제 규칙(regulatory rule)'과 '보험 계약(insurance contract)'의 두 용어를 사용하여 명확한 모델링이 가능합니다.

### 동의어

유비쿼터스 언어에서 두 용어는 서로 바꿔 사용할 수 없습니다. 예를 들어, '사용자'라는 용어는 수신에 순수히 시스템에서 사용됩니다. 그러나 도메인 전문가의 언어는 신중하게 선별된 의미 '사용자', '관리자', '계정' 등 다른 용어가 용인되는 것을 말 건설 수 있습니다.

유비쿼터스 언어는 처음에는 해괴 보이지 않습니다. 그러나 대부분의 경우 다른 개념을 가진다면 각각이 어떤 '광문자'와 '계정' 모두 가술적으로 시스템의 사용자를 가리킵니다. 그러나 대부분은 미사한 의미를 가진 사용자와 동일한 사용자는 다른 엔결을 가지거나 다른 행동을 합니다. 예를 들어, '계정'이라는 주로 분석 목적으로 사용되는 반면, '계정'은 시스템의 기능을 실제로 사용합니다.

## 비즈니스 도메인 모델

이번에는 모델링의 관점에서 유비쿼터스 언어를 살펴보겠습니다.

### 모델이란 무엇인가?

> "모델이란 사용자는 현상에 관점 강조하고 다른 측면은 무시하여 간략하게 표현한 것이다. 즉, 특정 용도를 위중에 쓴 속성 결정이다."  
> — 레베카 워프스-브록(Rebecca Wirfs-Brock)

모델은 실제계의 복제가 아니라 우리가 실제 시스템을 이해하는 데 도움을 주는 인간의 창조물입니다.

### 효과적인 모델링

모든 모델에는 목적이 있고 효과적인 모델은 그 목적을 달성하는 데 필요한 세부사항만 포함합니다. 예를 들어, 세계 지도에서는 지하철 정차역 정보를 찾을 수 없습니다. 반면, 지하철 노선도에서는 거리를 측정할 수 없습니다. 각 지도는 제공해야 할 정보만을 포함합니다.

바로 이 점이 중요합니다. 즉, 유용한 모델은 실제계의 복사본이 아니라 문제를 해결하려는 의도가 있으며, 그 목적에 필요한 정보만 제공해야 합니다.

> "모든 모델은 문제가 있지만, 일부는 유용하다(All models are wrong, some are useful)."  
> — 조지 박스(George Box)

### 비즈니스 도메인 모델링

유비쿼터스 언어는 어디서 도메인의 모든 가능한 상세 정보를 포함하는 게 아닙니다. 다른 모든 모델처럼 비즈니스 도메인 모델도 문제 해결에 특화된 것입니다.

모델은 도메인 전문가와 만들어야 합니다. 반드시 모델은 필요한 시스템을 구축하는 것에 소프트웨어를 해결하고자 하는 특정 문제를 해결하는 데 필요한 만큼만의 비즈니스 도메인 정보를 포함해야 합니다.

엔지니어링 팀과 도메인 전문가의 효과적인 커뮤니케이션은 필수이며, 비즈니스 도메인의 복잡성 수에 커뮤니케이션의 중요성은 커집니다. 비즈니스 도메인의 복잡성에 따라 비즈니스 조직을 모델링하고 코드로 구현하기가 어렵습니다. 비즈니스 도메인의 이해를 확인할 신뢰성 있는 유일한 방법은 도메인 전문가가 이해할 수 있는 비즈니스 언어로 대화하는 것입니다.

### 지속적인 노력

유비쿼터스 언어를 경험화(formulation)하려면 언어의 소유권이 도메인 전문가의 상호작용을 해야 합니다. 오직 실제 도메인 전문가의 상호작용만이 비즈니스 도메인에 대한 무분명한 점을 찾아, 가정, 또는 전체적인 이해 오류를 발전할 수 있습니다.

모든 이해관계자는 모든 프로젝트와 관련된 커뮤니케이션에서 유비쿼터스 언어를 지속적으로 사용해야 합니다.

## 도구

유비쿼터스 언어를 수집하고 관리하는 과정을 돕는 도구와 기술이 있습니다.

### 용어집(Glossary)

유비쿼터스 언어를 수집하고 관리하는 용어집(glossary)으로 사용될 수 있습니다. 이런 용어집은 비즈니스 도메인에 대한 정보를 얻을 수 있는 거정 역할을 하고 새로운 팀원이 적응하는 데 특히 유용합니다.

또한 팀 함께 용어집을 유지보수하는 것이 주요 소유다. 유비쿼터스 언어가 변경되면 모든 팀원들이 수정할 수 있게 독려해야 합니다. 다른 리더가 아닌에서 팀 용어집 유지보수를 담당하는 것은 중앙집중식 방식입니다.

프로젝트 용어집을 유지보수하기 적절한 정의 명령대로만 불구하고, 까다로운 논쟁적인 항목이 될 수 있습니다. 용어집은 언어의 이름, 작중, 역할 등의 **명사(noun)**와 형태와 보치만, 행사가 조요스러운 하지만 행동을(behavior)을 포착하기는 것은 중요하고, 행동을 단순이 사전에서 관련한 설명하기는 어렵습니다.

### 거킨 테스트(Gherkin Test)

거킨 언어(Gherkin language)로 작성한 자동화 테스트는 유비쿼터스 언어를 포착하기에 좋은 언어일 뿐 아니라 도메인 전문가는 소프트웨어 엔지니어와 긴간를 배우기 쉽고 도구로서의 역할을 할 수 있습니다. 도메인 전문가는 테스트를 읽고 시스템의 기대 행동을 검증할 수 있습니다.

```gherkin
Scenario: 에이전트에게 새로운 지원 케이스에 대해 알립니다.
  Given: 빈센트 줄스(Vincent Jules)는 다음 내용을 담은 새로운 지원 케이스를 제출합니다.
    나는 AWS Infinidash를 설정하는 데 도움이 필요합니다.
  When: 티켓이 울프 씨(Mr. Wolf)에게 할당되면
  Then: 에이전트는 티켓에 대해 알림을 받습니다.
```

## 도전과제

### 도메인 전문가의 존재

이 기법에 경험이 풍부한 이 과정에서 더른 존재는 지식을 발전하는 것보다 않습니다. 이러한 도메인 문제가 할때에서 포함을 함께 현업에게는 처우 프로를테스 되는 사람을 알게 해야 합니다.

특히 핵심 하위 도메인의 경우에 일반적입니다. 이런 과정은 도메인 전문가가 자신의 영역을 더 이해하도록 돕는 상호보완적인 배움의 과정가되기도 합니다.

브랜돌리니는 프로젝트에 도메인 주도 설계 실천을 적용할 때 프로젝트에서 비즈니스 도메인을 표현하는 언어가 이미 있다면 이해관계자가 사용하고 또 수 있습니다. 하지만 그것이 DDD를 함 따르지 않아서 비즈니스 도메인을 표현하고 정할을 수 없게 됩니다. 예를 들어, 기존의 시스템 데이터를과 같은 기술적인 용어를 사용할 수 있습니다. 조직에서 이미 사용하고 있는 언어가 무분는 것은 실직 없을 것입니다. 이 경우 필요한 도구는 바로 언어입니다. 문서나 소스코드의 해석에이기 쉬운 부분만 올해의 언어을 사용하도록 합니다.

## 결론

효과적인 커뮤니케이션이 지식 공유는 성공적인 소프트웨어 프로젝트의 필수입니다. 소프트웨어의 엔지니어가 소프트웨어 솔루션을 설계하고 개발하기 위해서는 반드시 비즈니스 도메인을 이해하여야 합니다.

도메인 주도 설계의 유비쿼터스 언어는 도메인 전문과 소프트웨어 엔지니어의 지식 간극을 해결주는 도과적인 도구다. 단, 문서, 테스트, 다이어그램, 소스코드 등 프로젝트 전반에 걸쳐 모든 이해관계자가 공유된 언어를 사용함으로써 커뮤니케이션과 지식 공유를 강화합니다.

효과적인 커뮤니케이션을 위해서 유비쿼터스 언어에는 반드시 모호성과 암묵적 가정을 제거해야 합니다. 언어의 모든 용어는 일관성이 있어야 하므로지 같은 뜻이어야 합니다.

유비쿼터스 언어를 육성하는 것은 지속적 과정입니다. 프로젝트가 발전하면서 더 많은 도메인 지식이 발견됩니다. 이런 불굴의 정신 유비쿼터스 언어에 반영되는 것이 중요합니다.

위기 거린 용어집과 거킨 테스트 같은 도구는 유비쿼터스 언어를 문서화하고 유지보수하는 데 상당히 실력 활용됩니다. 그러나 효과적인 유비쿼터스 언어의 전문조건은 언어를 사용해 이야기하는 것입니다.
