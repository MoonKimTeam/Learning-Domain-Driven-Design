# ch.04 바운디드 컨텍스트 연동

- 바운디드 컨텍스트의 구현은 서로 독립적으로 발전할 수 있지만, 상호 작용해야 함
- 컨트랙트: 바운디드 컨텍스트 사이의 접점

## 협력형 패턴 그룹

- 소통이 잘되는 팀에서 구현된 바운디드 컨텍스트

### 파트너십 패턴

- 애드혹 방식으로 조정
- 한 팀은 다른 팀에게 API의 변경을 알리고 다른팀은 추돌 없이 이를 받아들임

### 공유 커널 패턴

- 하위 도메인의 동일 모델 혹은 그 일부가 다른 바운디드 컨텍스트에서 구현되는 경우(공유 커널)

#### 공유 범위

- 수명주기가 서로 엮이게 되며, 연쇄 영향을 최소화하려면 양쪽의 겹치는 모델을 제한해서 바운디드 컨텍스트에서 공통으로 구현되어야하는 모델의 일부분만 노출하도록 해야 함

#### 구현

- 공유 커널은 모든 변경이 이를 사용하는 모든 바운디드 컨텍스트에 즉시 반영되도록 구현됨

#### 공유 커널을 사용해야 하는 경우

- 두 바운디드 컨텍스트가 공유하는 코드베이스에 대한 변경을 조율하려는 노력보다 공유하는 모델에 대한 변경을 통합할 때 드는 노력이 더 클 경우 적용

## 사용자-제공자 패턴

- 업스트림(서비스 제공자) 또는 다운스트림(사용자)의 팀이 연동 컨트랙트를 주도하는 불균형이 존재
- 세 가지 패턴 존재

### 순응주의자

- 사용자의 요구를 지원할 동기가 없는 경우
- 제공자의 모델에 따라 정의된 연동 컨트랙트를 제공할 뿐
- 다운스트림 팀이 업스트림 팀의 모델을 받아들이는 관계

### 충돌 방지 계층 패턴

- 다운스트림 바운디드 컨텍스트가 이에 순응하지 않는 경우, 충돌 방지 계층을 통해 업스트림 바운디드 컨텍스트의 모델을 스스로의 필요에 맞게

### 오픈 호스트 서비스 패턴

- 힘이 사용자 측에 있을 경우
- 구현 모델의 변경으로부터 사용자를 보호하기 위해 업스트림 제공자는 퍼블릭 인터페이스와 구현 모델을 분리
- 충돌 방지 계층 패턴의 반대

## 분리형 노선

- 팀에 협업 의지가 없거나 협업할 수 없는 경우

### 커뮤니케이션 이슈

- 조직의 규모와 내부 정치 요인으로 인한 커뮤니케이션의 어려움

### 일반 하위 도메인

- 하위 도메인의 특성이 중복되거나 일반 하위도메인이 일반 솔루션과 연동하는 것이 쉬운 경우

### 모델의 차이

- 모델이 너무 달라서 순응주의자 관계가 불가능하고 충돌 방지 계층을 구현하는 것도 기능 중복보다 비용이 더 클 수 있음

## 컨텍스트 맵

- 컨텍스트 맵은 시스템의 바운디드 컨텍스트와의 연동을 시각적으로 표현함

### 유지보수

- 컨텍스트 맵은 여러 팀이 작업한 정보를 담기 때문에 다 함께 유지보수하는 것이 좋음

### 한계

- 컨텍스트 맵 작성은 어려움
- 여러 하위 도메인에 걸친 시스템의 바운디드 컨텍스트에는 작동하는 여러 연동 패턴이 있을 수 있음
